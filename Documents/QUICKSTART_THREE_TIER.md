# 🚀 三層架構快速開始指南

## 🎯 核心概念

SportFlow 現在採用**三層賽事架構**，類似於國際標準賽制：

```
Tournament（錦標賽）
    ↓
Category（分類）- 男子雙打、女子單打、混合雙打等
    ↓
Stage（階段）- 小組賽 → 淘汰賽
```

## 📝 使用流程

### 作為主辦方

#### 步驟 1：創建賽事

1. 導航到「主辦方首頁」→「創建賽事」
2. **Step 1 - 基本資訊**

   - 輸入賽事名稱：「2025 台北春季公開賽」
   - 選擇球類：匹克球
   - 上傳 Banner（可選）

3. **Step 2 - 時間地點**

   - 選擇比賽日期
   - 設定報名截止日期
   - 輸入比賽地點

4. **Step 3 - 分類設定**（新功能！）

   - 點擊「新增分類」
   - 設定第一個分類：
     ```
     名稱：男子雙打
     類型：雙打
     名額：20 組
     賽制：小組賽 + 淘汰賽
     ```
   - 再新增第二個分類：
     ```
     名稱：女子單打
     類型：單打
     名額：16 人
     賽制：純淘汰賽
     季軍賽：✓ 啟用
     ```

5. **Step 4 - 文宣說明**
   - 輸入賽事說明（可選）
   - 點擊「建立賽事」

#### 步驟 2：開放報名

1. 進入「賽事控制台」
2. 點擊「開放報名」
3. 選手開始報名

#### 步驟 3：發布賽程

1. 等待報名結束（或手動截止報名）
2. 審核參賽者
3. **按 Category 發布賽程**：

   - 切換到「男子雙打」分類
   - 查看已確認的隊伍（13 組）
   - **系統自動推薦分組方案**：

     ```
     方案 A（推薦）：
       4 組（3,3,3,4 隊）
       每組取前 2 名 → 8 強淘汰賽
       總場次：26 場

     方案 B：
       3 組（4,4,5 隊）
       每組取前 2 名 + 2 個最佳第 3 名 → 8 強
       總場次：23 場
     ```

   - 選擇方案或自訂分組
   - 點擊「發布賽程」

#### 步驟 4：進行比賽

- 小組賽全部打完後
- 系統自動計算排名
- 自動填入淘汰賽樹狀圖
- 進入淘汰賽階段

### 作為選手

#### 單打報名

1. 瀏覽賽事列表
2. 點擊感興趣的賽事
3. 點擊「報名」
4. **選擇分類**：「女子單打」
5. 確認姓名
6. 提交報名

#### 雙打報名

1. 瀏覽賽事列表
2. 點擊感興趣的賽事
3. 點擊「報名」
4. **選擇分類**：「男子雙打」
5. 輸入自己的姓名
6. **輸入隊友 Email** → 點擊「搜尋」
   - 如果找到：系統顯示隊友資料
   - 如果沒找到：手動輸入隊友姓名
7. 提交報名

### 作為紀錄員（功能保留）

#### 記錄比賽

1. 進入「我的場次」
2. 選擇分配給自己的比賽
3. 點擊「開始比賽」
4. 記錄得分（+1 按鈕）
5. **比賽結束**：
   - 系統自動判定勝者
   - **自動晉級到下一場** 🚀
   - 自動釋放場地
   - 自動分配場地給等待中的比賽

## 🎨 UI 導覽

### 賽事詳情頁

```
┌─────────────────────────────────┐
│ 台北春季公開賽                  │
│ 2025/03/15                      │
├─────────────────────────────────┤
│ Tabs: [類別] [圖庫] [結果] [信息] │
├─────────────────────────────────┤
│                                 │
│ ┌─ 男子雙打 ───────────────┐   │
│ │ Doubles Open              │   │
│ │ 18/20 組已報名         → │   │
│ └───────────────────────────┘   │
│                                 │
│ ┌─ 女子單打 ───────────────┐   │
│ │ Women's Singles           │   │
│ │ 12/16 人已報名         → │   │
│ └───────────────────────────┘   │
└─────────────────────────────────┘
```

### 分類詳情頁（Category Detail）

```
┌─────────────────────────────────┐
│ MEN'S DOUBLES                   │
├─────────────────────────────────┤
│ Tabs: [小組] [對陣圖] [球員]    │
├─────────────────────────────────┤
│                                 │
│ === 小組 Tab ===                │
│ Group A                         │
│ ┌───────────────────────────┐   │
│ │ 隊伍    PTS  W  L  PD     │   │
│ │ 1. A/B   6   3  0  +12 ✓ │   │
│ │ 2. C/D   4   2  1  +5  ✓ │   │
│ │ 3. E/F   2   1  2  -3    │   │
│ └───────────────────────────┘   │
│                                 │
│ === 對陣圖 Tab ===              │
│ Sub-tabs: [QF] [SF] [FI] [3RD] │
│                                 │
│ === 球員 Tab ===                │
│ 顯示所有已確認的隊伍            │
└─────────────────────────────────┘
```

## 技巧與最佳實踐

### 主辦方技巧

1. **合理設定名額**

   - 小組賽建議：12-24 隊（4 組 x 3-6 隊）
   - 純淘汰賽：2 的次方數最理想（8, 16, 32）

2. **善用智能推薦**

   - 系統會自動計算最平衡的分組
   - 優先選擇「推薦」方案

3. **混合賽制優勢**
   - 保證每支隊伍至少打 3-5 場（小組賽）
   - 小組第一更有優勢（交叉賽制）

### 選手技巧

1. **雙打配對**

   - 先和隊友約好
   - 其中一人報名時選擇對方
   - 建議雙方都有註冊帳號

2. **報名時機**
   - 盡早報名確保名額
   - 關注報名進度（12/16 已報名）

## 🔗 相關資源

- **實施文檔**: `THREE_TIER_ARCHITECTURE_IMPLEMENTATION.md`
- **Firebase 配置**: `FIREBASE_CONFIG_UPDATE.md`
- **編譯狀態**: `BUILD_STATUS.md`
- **完整計劃**: `.cursor/plans/三層賽事架構重構_df51a3dd.plan.md`

## ❓ 常見問題

### Q: 舊的賽事數據還能用嗎？

A: 可以讀取但無法編輯。建議新賽事使用新架構創建。

### Q: 索引建立需要多久？

A: 通常 5-30 分鐘，大數據量可能需要數小時。

### Q: 為什麼看到「索引建立中」訊息？

A: 這是正常現象，表示 Firebase 正在背景建立新索引。功能不受影響。

### Q: 雙打隊友不接受怎麼辦？

A: 目前系統自動確認。未來版本可以添加邀請確認機制。

### Q: 可以同時報名多個分類嗎？

A: 可以！同一個用戶可以報名「男子雙打」和「混合雙打」。

### Q: 自動晉級功能還在嗎？

A: 完全保留！比賽完成後勝者自動填入下一場。

---

**最後更新**: 2024 年 12 月 21 日  
**版本**: v2.0 - 三層架構  
**狀態**: 生產就緒
