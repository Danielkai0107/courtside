# ğŸ“§ Email é€šçŸ¥è¨­å®šæŒ‡å—

## ğŸ¯ Email é€šçŸ¥åŠŸèƒ½

ç•¶ä»¥ä¸‹äº‹ä»¶ç™¼ç”Ÿæ™‚ï¼Œç³»çµ±æœƒè‡ªå‹•ç™¼é€ Emailï¼š

1.  **é¸æ‰‹å ±åè¢«ç¢ºèª** â†’ é€šçŸ¥é¸æ‰‹
2.  **è³½ç¨‹ç™¼å¸ƒ** â†’ é€šçŸ¥æ‰€æœ‰å·²ç¢ºèªé¸æ‰‹
3.  **å·¥ä½œäººå“¡é‚€è«‹** â†’ é€šçŸ¥è¢«é‚€è«‹çš„å·¥ä½œäººå“¡

## âš™ï¸ è¨­å®šæ­¥é©Ÿ

### æ–¹æ³• 1ï¼šä½¿ç”¨ Gmail SMTPï¼ˆæ¨è–¦æ¸¬è©¦ç”¨ï¼‰

#### æ­¥é©Ÿ 1ï¼šæº–å‚™ Gmail æ‡‰ç”¨ç¨‹å¼å¯†ç¢¼

1. å‰å¾€ [Google å¸³æˆ¶è¨­å®š](https://myaccount.google.com/)
2. é¸æ“‡ã€Œå®‰å…¨æ€§ã€
3. å•Ÿç”¨ã€Œå…©æ­¥é©Ÿé©—è­‰ã€ï¼ˆå¦‚æœå°šæœªå•Ÿç”¨ï¼‰
4. åœ¨ã€Œå…©æ­¥é©Ÿé©—è­‰ã€é é¢ï¼Œæ‰¾åˆ°ã€Œæ‡‰ç”¨ç¨‹å¼å¯†ç¢¼ã€
5. ç”¢ç”Ÿæ–°çš„æ‡‰ç”¨ç¨‹å¼å¯†ç¢¼ï¼ˆé¸æ“‡ã€Œå…¶ä»–ã€â†’ è¼¸å…¥ã€ŒSportFlowã€ï¼‰
6. è¤‡è£½ç”¢ç”Ÿçš„ 16 ä½å¯†ç¢¼ï¼ˆæ ¼å¼ï¼šxxxx xxxx xxxx xxxxï¼‰

#### æ­¥é©Ÿ 2ï¼šè¨­å®š Firebase Functions ç’°å¢ƒè®Šæ•¸

åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„åŸ·è¡Œï¼š

```bash
# è¨­å®šç™¼é€ Email çš„ Gmail å¸³è™Ÿ
firebase functions:config:set email.user="your-email@gmail.com"

# è¨­å®šæ‡‰ç”¨ç¨‹å¼å¯†ç¢¼ï¼ˆå»é™¤ç©ºæ ¼ï¼‰
firebase functions:config:set email.password="xxxxxxxxxxxxxxxx"

# è¨­å®šæ‡‰ç”¨ç¨‹å¼ URLï¼ˆç”¨æ–¼ Email ä¸­çš„é€£çµï¼‰
firebase functions:config:set app.url="http://localhost:5173"

# ç¢ºèªè¨­å®š
firebase functions:config:get
```

#### æ­¥é©Ÿ 3ï¼šéƒ¨ç½² Functions

```bash
firebase deploy --only functions
```

### æ–¹æ³• 2ï¼šä½¿ç”¨ SendGridï¼ˆæ¨è–¦æ­£å¼ç’°å¢ƒï¼‰

å¦‚æœæƒ³ä½¿ç”¨æ›´å°ˆæ¥­çš„ Email æœå‹™ï¼š

1. è¨»å†Š [SendGrid](https://sendgrid.com/)ï¼ˆå…è²»é¡åº¦ï¼šæ¯å¤© 100 å°ï¼‰
2. å–å¾— API Key
3. ä¿®æ”¹ `functions/src/notifications/emailService.ts`ï¼š

```typescript
// æ›¿æ› transporter é…ç½®
const transporter = nodemailer.createTransport({
  host: "smtp.sendgrid.net",
  port: 587,
  auth: {
    user: "apikey",
    pass: functions.config().sendgrid?.apikey || process.env.SENDGRID_API_KEY,
  },
});
```

4. è¨­å®šç’°å¢ƒè®Šæ•¸ï¼š

```bash
firebase functions:config:set sendgrid.apikey="your-sendgrid-api-key"
```

## ğŸš€ éƒ¨ç½² Functions

### é¦–æ¬¡éƒ¨ç½²

```bash
# ç¢ºä¿åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„
cd /Users/danielkai/Desktop/sportflow

# éƒ¨ç½² Functions
firebase deploy --only functions
```

### æŸ¥çœ‹éƒ¨ç½²ç‹€æ…‹

```bash
# æŸ¥çœ‹ Functions åˆ—è¡¨
firebase functions:list

# æŸ¥çœ‹ Functions æ—¥èªŒ
firebase functions:log
```

## ğŸ§ª æ¸¬è©¦ Email é€šçŸ¥

### 1. æ¸¬è©¦å ±åç¢ºèªé€šçŸ¥

1. ä½¿ç”¨ä¸€èˆ¬ç”¨æˆ¶è§’è‰²å ±åè³½äº‹
2. åˆ‡æ›åˆ°ä¸»è¾¦æ–¹è§’è‰²
3. å‰å¾€è³½äº‹å„€è¡¨æ¿ â†’ äººå“¡ç®¡ç†
4. æ‰¹å‡†é¸æ‰‹å ±å
5. æŸ¥çœ‹è©²é¸æ‰‹çš„ Email ä¿¡ç®±

### 2. æ¸¬è©¦è³½ç¨‹ç™¼å¸ƒé€šçŸ¥

1. ä¸»è¾¦æ–¹é€²è¡ŒæŠ½ç±¤
2. ç™¼å¸ƒè³½ç¨‹
3. æ‰€æœ‰å·²ç¢ºèªé¸æ‰‹æœƒæ”¶åˆ°é€šçŸ¥

### 3. æ¸¬è©¦å·¥ä½œäººå“¡é‚€è«‹

1. ä¸»è¾¦æ–¹é‚€è«‹å·¥ä½œäººå“¡
2. è¢«é‚€è«‹è€…æœƒæ”¶åˆ° Email

## ğŸ“Š ç•¶å‰ç‹€æ…‹

### å·²å®Œæˆ

- Functions ç¨‹å¼ç¢¼å·²å»ºç«‹
- Email æ¨¡æ¿å·²è¨­è¨ˆ
- Functions ä¾è³´å·²å®‰è£

### â¸ï¸ å¾…å®Œæˆ

- è¨­å®š Email æ†‘è­‰ï¼ˆGmail æˆ– SendGridï¼‰
- éƒ¨ç½² Functions åˆ° Firebase

## ğŸ” é™¤éŒ¯

### æŸ¥çœ‹ Functions åŸ·è¡Œç‹€æ³

```bash
# å³æ™‚æŸ¥çœ‹æ—¥èªŒ
firebase functions:log --only onPlayerConfirmed,onSchedulePublished,onStaffInvited
```

### å¸¸è¦‹å•é¡Œ

#### Q: Email æ²’æœ‰ç™¼é€ï¼Ÿ

**A:** æª¢æŸ¥ï¼š

1. Functions ç’°å¢ƒè®Šæ•¸æ˜¯å¦æ­£ç¢ºè¨­å®š
2. Functions æ˜¯å¦å·²éƒ¨ç½²
3. Gmail æ‡‰ç”¨ç¨‹å¼å¯†ç¢¼æ˜¯å¦æ­£ç¢º
4. æŸ¥çœ‹ Functions æ—¥èªŒæ˜¯å¦æœ‰éŒ¯èª¤

#### Q: Gmail é¡¯ç¤ºã€Œä¸å¤ å®‰å…¨çš„æ‡‰ç”¨ç¨‹å¼ã€ï¼Ÿ

**A:** ä½¿ç”¨ã€Œæ‡‰ç”¨ç¨‹å¼å¯†ç¢¼ã€è€Œéå¸³è™Ÿå¯†ç¢¼

#### Q: ç™¼é€å¤±æ•—ã€Œ535 Authentication failedã€ï¼Ÿ

**A:** æª¢æŸ¥ Email å’Œå¯†ç¢¼æ˜¯å¦æ­£ç¢º

## ğŸ“ Email ç¯„æœ¬é è¦½

### å ±åç¢ºèª Email

```
ä¸»æ—¨ï¼šå ±åç¢ºèª - [è³½äº‹åç¨±]

å—¨ [é¸æ‰‹å§“å]ï¼Œ

æ‚¨çš„å ±åå·²ç¶“ç¢ºèªï¼

è³½äº‹è³‡è¨Š
è³½äº‹åç¨±ï¼š[åç¨±]
æ¯”è³½æ—¥æœŸï¼š[æ—¥æœŸ]
æ¯”è³½åœ°é»ï¼š[åœ°é»]

è«‹è¨˜å¾—æº–æ™‚åˆ°å ´ã€‚ç¥æ¯”è³½é †åˆ©ï¼
```

### è³½ç¨‹ç™¼å¸ƒ Email

```
ä¸»æ—¨ï¼šè³½ç¨‹å·²ç™¼å¸ƒ - [è³½äº‹åç¨±]

å—¨ [é¸æ‰‹å§“å]ï¼Œ

[è³½äº‹åç¨±] çš„è³½ç¨‹å·²ç¶“ç™¼å¸ƒï¼

è«‹å‰å¾€ SportFlow æŸ¥çœ‹æ‚¨çš„æ¯”è³½æ™‚é–“èˆ‡å°æ‰‹è³‡è¨Šã€‚

[æŸ¥çœ‹è³½ç¨‹] æŒ‰éˆ•
```

### å·¥ä½œäººå“¡é‚€è«‹ Email

```
ä¸»æ—¨ï¼šå·¥ä½œäººå“¡é‚€è«‹ - [è³½äº‹åç¨±]

å—¨ [å§“å]ï¼Œ

æ‚¨è¢«é‚€è«‹æ“”ä»» [è³½äº‹åç¨±] çš„ [è§’è‰²]ã€‚

è«‹ç™»å…¥ SportFlow ä»¥æŸ¥çœ‹è©³æƒ…ä¸¦æ¥å—é‚€è«‹ã€‚

[å‰å¾€ SportFlow] æŒ‰éˆ•
```

## ğŸ” å®‰å…¨æ³¨æ„äº‹é …

1. **ä¸è¦å°‡å¯†ç¢¼æäº¤åˆ° Git**

   - Email å¯†ç¢¼åƒ…å­˜åœ¨ Firebase Functions config
   - ä½¿ç”¨ `.gitignore` å¿½ç•¥æ•æ„Ÿæª”æ¡ˆ

2. **ç”Ÿç”¢ç’°å¢ƒå»ºè­°**

   - ä½¿ç”¨å°ˆæ¥­ Email æœå‹™ï¼ˆSendGrid, AWS SESï¼‰
   - è¨­å®š SPFã€DKIM è¨˜éŒ„
   - ç›£æ§ç™¼é€é¡åº¦

3. **Email é™åˆ¶**
   - Gmailï¼šæ¯å¤©ç´„ 500 å°
   - SendGrid å…è²»ï¼šæ¯å¤© 100 å°
   - æ­£å¼ç’°å¢ƒå»ºè­°å‡ç´šæ–¹æ¡ˆ

---

**ä¸‹ä¸€æ­¥**ï¼šè¨­å®š Email æ†‘è­‰å¾ŒåŸ·è¡Œ `firebase deploy --only functions` ğŸš€
