# Sports é›†åˆçµæ§‹æ›´æ–°

## æ›´æ–°æ—¥æœŸ
2024-12-23

## æ¦‚è¿°
æ ¹æ“š Firestore è³‡æ–™åº«ä¸­çš„å¯¦éš›çµæ§‹ï¼Œæ›´æ–°äº†å°ˆæ¡ˆä¸­ Sport é¡å‹å®šç¾©å’Œç›¸é—œåŠŸèƒ½ï¼Œä»¥æ”¯æ´æ›´å®Œæ•´çš„é‹å‹•é …ç›®é…ç½®ç³»çµ±ã€‚

## æ–°çš„ Sport çµæ§‹

### Firestore æ–‡æª”çµæ§‹
```typescript
{
  id: string;                    // æ–‡æª” IDï¼ˆå¦‚ "badminton"ï¼‰
  name: string;                  // é‹å‹•åç¨±ï¼ˆå¦‚ "ç¾½æ¯›çƒ"ï¼‰
  icon: string;                  // åœ–ç¤º emojiï¼ˆå¦‚ ""ï¼‰
  isActive: boolean;             // æ˜¯å¦å•Ÿç”¨
  order: number;                 // æ’åº
  defaultPresetId: string;       // é è¨­è¦å‰‡ IDï¼ˆå¦‚ "bwf_standard"ï¼‰
  modes: string[];               // å¯ç”¨æ¨¡å¼ï¼ˆå¦‚ ["singles", "doubles"]ï¼‰
  rulePresets: RulePreset[];     // è¦å‰‡é è¨­åˆ—è¡¨
  createdAt: Timestamp;
  updatedAt: Timestamp;
}
```

### RulePreset çµæ§‹
```typescript
{
  id: string;                    // è¦å‰‡ IDï¼ˆå¦‚ "bwf_standard"ï¼‰
  label: string;                 // é¡¯ç¤ºåç¨±ï¼ˆå¦‚ "BWF æ¨™æº–è³½åˆ¶"ï¼‰
  description: string;           // èªªæ˜ï¼ˆå¦‚ "æ¯å±€21åˆ†ï¼Œ3å±€2å‹ï¼Œ30åˆ†å°é ‚"ï¼‰
  config: {
    cap: number;                 // åƒè³½äººæ•¸ä¸Šé™
    matchType: "set_based" | "point_based";  // æ¯”è³½é¡å‹
    maxSets: number;             // æœ€å¤šå±€æ•¸
    pointsPerSet: number;        // æ¯å±€åˆ†æ•¸
    setsToWin: number;           // ç²å‹æ‰€éœ€å±€æ•¸
    winByTwo: boolean;           // æ˜¯å¦éœ€è¦è´å…©åˆ†
  }
}
```

## ä¸»è¦è®Šæ›´

### 1. å‹åˆ¥å®šç¾©æ›´æ–°
**æª”æ¡ˆ**: `src/types/index.ts`

- ç§»é™¤äº† `nameEn` å’Œ `availableFormats` æ¬„ä½
- æ–°å¢ `RulePresetConfig` å’Œ `RulePreset` ä»‹é¢
- æ›´æ–° `Sport` ä»‹é¢ä»¥ç¬¦åˆæ–°çµæ§‹
- æ–°å¢ `modes` å’Œ `rulePresets` æ¬„ä½

### 2. åˆå§‹åŒ–è…³æœ¬æ›´æ–°
**æª”æ¡ˆ**: `src/scripts/initSports.ts`

æ–°å¢ä¸‰å€‹é‹å‹•é …ç›®çš„åˆå§‹åŒ–å‡½æ•¸ï¼š

#### ç¾½æ¯›çƒ (Badminton)
- **ID**: `badminton`
- **åœ–ç¤º**: 
- **è¦å‰‡é è¨­**:
  1. BWF æ¨™æº–è³½åˆ¶ï¼ˆæ¯å±€21åˆ†ï¼Œ3å±€2å‹ï¼Œ30åˆ†å°é ‚ï¼‰
  2. å–®å±€30åˆ†åˆ¶ï¼ˆå¿«é€Ÿæ¯”è³½ï¼‰
  3. å–®å±€21åˆ†åˆ¶ï¼ˆ2åˆ†é ˜å…ˆï¼Œ30åˆ†å°é ‚ï¼‰

#### åŒ¹å…‹çƒ (Pickleball)
- **ID**: `pickleball`
- **åœ–ç¤º**: ğŸ“
- **è¦å‰‡é è¨­**:
  1. æ¨™æº–11åˆ†åˆ¶ï¼ˆæ¯å±€11åˆ†ï¼Œ3å±€2å‹ï¼Œ15åˆ†å°é ‚ï¼‰
  2. å–®å±€21åˆ†åˆ¶ï¼ˆå¿«é€Ÿæ¯”è³½ï¼‰

#### æ¡Œçƒ (Table Tennis)
- **ID**: `table_tennis`
- **åœ–ç¤º**: ğŸ“
- **è¦å‰‡é è¨­**:
  1. æ¨™æº–11åˆ†åˆ¶ï¼ˆæ¯å±€11åˆ†ï¼Œ5å±€3å‹ï¼‰
  2. 7å±€4å‹åˆ¶

### 3. CategoryManager å…ƒä»¶æ›´æ–°
**æª”æ¡ˆ**: `src/components/features/CategoryManager.tsx`

- æ–°å¢ `sport` prop ä»¥æ¥æ”¶é‹å‹•é …ç›®è³‡æ–™
- æ–°å¢ `rulePresetId` åˆ° `CategoryFormData`
- æ–°å¢è¦å‰‡é è¨­é¸æ“‡å™¨ï¼Œé¡¯ç¤ºæ‰€æœ‰å¯ç”¨çš„è¦å‰‡é è¨­
- è‡ªå‹•æ ¹æ“šé¸æ“‡çš„è¦å‰‡é è¨­è¨­å®š `pointsPerSet`
- æ–°å¢ `handleRulePresetChange` å‡½æ•¸è™•ç†è¦å‰‡è®Šæ›´

### 4. CreateTournament é é¢æ›´æ–°
**æª”æ¡ˆ**: `src/pages/organizer/CreateTournament.tsx`

- ç§»é™¤å° `nameEn` çš„å¼•ç”¨
- ä½¿ç”¨ `sport.id` ä½œç‚º `sportType`
- å‚³é `sport` prop çµ¦ `CategoryManager`
- åœ¨é‹å‹•é …ç›®å¡ç‰‡ä¸­é¡¯ç¤º `modes` è€Œé `nameEn`
- å¾è¦å‰‡é è¨­ä¸­è‡ªå‹•ç²å–é è¨­åˆ†æ•¸

## ä½¿ç”¨æ–¹å¼

### åˆå§‹åŒ–é‹å‹•é …ç›®è³‡æ–™

1. **åœ¨ç€è¦½å™¨ Console åŸ·è¡Œ**:
```javascript
// åˆå§‹åŒ–æ‰€æœ‰é‹å‹•é …ç›®
await window.initAllSports();

// æˆ–å–®ç¨åˆå§‹åŒ–
await window.initBadminton();
await window.initPickleball();
await window.initTableTennis();
```

2. **åœ¨ç¨‹å¼ç¢¼ä¸­ä½¿ç”¨**:
```typescript
import { initAllSports } from './scripts/initSports';

// åœ¨é©ç•¶çš„åœ°æ–¹å‘¼å«
await initAllSports();
```

### å»ºç«‹è³½äº‹æ™‚ä½¿ç”¨è¦å‰‡é è¨­

ç•¶ä¸»è¾¦æ–¹å»ºç«‹è³½äº‹ä¸¦æ–°å¢åˆ†é¡æ™‚ï¼š

1. é¸æ“‡é‹å‹•é …ç›®ï¼ˆå¦‚ç¾½æ¯›çƒï¼‰
2. é€²å…¥åˆ†é¡è¨­å®šæ­¥é©Ÿ
3. æ–°å¢åˆ†é¡æ™‚ï¼Œå¯ä»¥é¸æ“‡é å®šç¾©çš„è¦å‰‡é è¨­
4. é¸æ“‡è¦å‰‡é è¨­å¾Œï¼Œæœƒè‡ªå‹•å¡«å…¥å°æ‡‰çš„æ¯”è³½é…ç½®

## è³‡æ–™é·ç§»

å¦‚æœæ‚¨çš„è³‡æ–™åº«ä¸­å·²æœ‰èˆŠçš„ Sport æ–‡æª”ï¼Œéœ€è¦åŸ·è¡Œä»¥ä¸‹æ­¥é©Ÿï¼š

1. å‚™ä»½ç¾æœ‰è³‡æ–™
2. åŸ·è¡Œ `initAllSports()` å‰µå»ºæ–°çš„é‹å‹•é …ç›®
3. æ›´æ–°ç¾æœ‰ Tournament çš„ `sportId` å¼•ç”¨
4. åˆªé™¤èˆŠçš„ Sport æ–‡æª”ï¼ˆå¦‚æœæœ‰ï¼‰

## å„ªé»

1. **éˆæ´»æ€§**: æ¯å€‹é‹å‹•é …ç›®å¯ä»¥æœ‰å¤šå€‹è¦å‰‡é è¨­
2. **å¯æ“´å±•æ€§**: è¼•é¬†æ–°å¢æ–°çš„é‹å‹•é …ç›®å’Œè¦å‰‡
3. **ä¸€è‡´æ€§**: æ‰€æœ‰è³½äº‹ä½¿ç”¨æ¨™æº–åŒ–çš„è¦å‰‡é…ç½®
4. **ä½¿ç”¨è€…å‹å–„**: ä¸»è¾¦æ–¹å¯ä»¥å¿«é€Ÿé¸æ“‡å¸¸ç”¨çš„æ¯”è³½è¦å‰‡
5. **ç¶­è­·æ€§**: è¦å‰‡é›†ä¸­ç®¡ç†ï¼Œæ˜“æ–¼æ›´æ–°

## æœªä¾†æ“´å±•

1. æ–°å¢æ›´å¤šé‹å‹•é …ç›®ï¼ˆæ’çƒã€ç±ƒçƒç­‰ï¼‰
2. æ”¯æ´è‡ªè¨‚è¦å‰‡é è¨­
3. è¦å‰‡é è¨­çš„ç‰ˆæœ¬æ§åˆ¶
4. åŒ¯å…¥/åŒ¯å‡ºè¦å‰‡é è¨­é…ç½®

## æ¸¬è©¦æª¢æŸ¥æ¸…å–®

- [ ] åŸ·è¡Œ `initAllSports()` æˆåŠŸå‰µå»ºé‹å‹•é …ç›®
- [ ] å»ºç«‹è³½äº‹æ™‚å¯ä»¥æ­£ç¢ºé¡¯ç¤ºé‹å‹•é …ç›®
- [ ] åˆ†é¡è¨­å®šä¸­å¯ä»¥é¸æ“‡è¦å‰‡é è¨­
- [ ] é¸æ“‡è¦å‰‡é è¨­å¾Œæ­£ç¢ºå¡«å…¥åˆ†æ•¸é…ç½®
- [ ] å»ºç«‹è³½äº‹æµç¨‹å®Œæ•´ç„¡èª¤
- [ ] æª¢æŸ¥ Firestore ä¸­çš„è³‡æ–™çµæ§‹æ­£ç¢º

## ç›¸é—œæª”æ¡ˆ

- `src/types/index.ts` - å‹åˆ¥å®šç¾©
- `src/scripts/initSports.ts` - åˆå§‹åŒ–è…³æœ¬
- `src/services/sportService.ts` - é‹å‹•é …ç›®æœå‹™
- `src/components/features/CategoryManager.tsx` - åˆ†é¡ç®¡ç†å…ƒä»¶
- `src/pages/organizer/CreateTournament.tsx` - å»ºç«‹è³½äº‹é é¢


